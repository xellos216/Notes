# 쿠키, 세션, 토큰

## 1. 기본 개념

### 쿠키(Cookie)  
- 클라이언트(브라우저)에 저장되는 작은 데이터 조각.  
- 서버가 `Set-Cookie` 헤더로 전달하면, 브라우저는 이후 같은 도메인 요청마다 자동으로 쿠키를 포함시킴.  
- 용량 제한이 있음(대략 4KB).  

### 세션(Session)  
- 서버 측에 저장되는 사용자 상태 정보.  
- 서버는 클라이언트마다 고유한 `세션ID`를 발급하고, 이 ID를 클라이언트의 쿠키에 저장.  
- 클라이언트는 요청 시 세션ID를 보내고, 서버는 해당 세션ID에 매핑된 사용자 정보를 사용.  

### 토큰(Token)  
- 인증 정보를 담은 문자열(보통 JWT 형태).  
- 서버에 상태를 저장하지 않고, 토큰 자체에 사용자 정보와 서명(Signature)을 포함.  
- 클라이언트가 요청 시 토큰을 헤더에 포함 → 서버는 서명을 검증해 유효성 판단.  

---

## 2. 비유

- **쿠키**: 놀이공원에서 손등에 찍어주는 도장. 입장할 때마다 보여줘야 함.  
- **세션**: 놀이공원 내부에서 “열쇠 보관소”에 맡겨둔 사물함. 키(세션ID)만 가지고 다니면 실제 물건(데이터)은 서버에 안전하게 보관.  
- **토큰**: 놀이공원에서 발급하는 1일 자유이용권. 종이에 날짜·이름·암호 서명이 적혀 있어서, 표 자체가 증명서 역할.  

---

## 3. 예시

- **쿠키**:  
  사용자가 “다크 모드” 설정을 하면 브라우저에 쿠키로 저장. 다음 방문 때 자동 적용.  

- **세션**:  
  사용자가 로그인하면 서버에 세션을 만들고, 세션ID를 클라이언트에 전달. 이후 페이지 이동 시마다 세션ID를 보내 인증 유지.  

- **토큰**:  
  모바일 앱 로그인 시 JWT를 발급받음. 이후 모든 API 요청에 `Authorization: Bearer <JWT>`를 넣어 인증. 서버는 토큰만 검증하면 됨.  

---

## 4. 차이점 정리

| 구분 | 쿠키 | 세션 | 토큰 |
|------|------|------|------|
| 저장 위치 | 클라이언트(브라우저) | 서버 | 클라이언트 |
| 용도 | 간단한 상태 저장 | 로그인 상태 유지 | 로그인 상태 유지 (Stateless) |
| 보안 | 조작/탈취 위험 있음 | 서버에 안전하게 저장 (클라이언트는 세션ID만 보유) | 서명 검증으로 위조 방지 가능 |
| 확장성 | 브라우저 의존적 | 서버 메모리/DB 사용, 사용자 많아지면 부담 | 서버 확장 용이 (무상태) |
| 크기 제한 | 4KB | 서버 자원 한도 | 토큰 길이 제한 없음(다만 커질 수 있음) |
| 만료 | 브라우저 쿠키 만료 시간 | 서버 세션 타임아웃 | 토큰 자체 만료 시간 포함 |

---

## 5. 실제 사용 방식

- **쿠키**:  
  사용자 UI 설정, 장바구니 임시 데이터 저장.  
  (예: “최근 본 상품” 목록)

- **세션**:  
  전통적인 로그인 유지.  
  (예: 쇼핑몰에서 로그인 후 여러 페이지 돌아다닐 때 인증 유지)

- **토큰(JWT)**:  
  REST API, 모바일 앱, 마이크로서비스 환경에서 주로 사용.  
  (예: 소셜 로그인 → JWT 발급 → 클라이언트가 토큰만으로 서버와 통신)  

---

## 6. 정리
- **쿠키는 클라이언트에 직접 저장되는 작은 메모지**  
- **세션은 서버에 맡기고 클라이언트는 열쇠만 들고 다니는 방식**  
- **토큰은 스스로 증명력을 가진 통행증**
